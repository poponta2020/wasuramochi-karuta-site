# 要件定義書：管理画面UI改善

**作成日**: 2026年2月11日
**対象**: 管理画面の全面リニューアル（モバイルファースト）

---

## 1. 現状と課題

### 1.1 現在の状態
- 管理画面は「活動報告」の管理機能のみ
- CMS用のDBテーブル（site_contents, karuta_cards, activity_cards, faq_items）はSupabase側に作成済み
- 公開ページの動的読み込み（site-loader.js）は未実装
- SupabaseClientのCMSメソッドは未実装

### 1.2 前回のUI（サイドバー方式）の課題
- モバイルでサイドバーが操作しにくい
- デザインが地味で管理アプリとしての魅力に欠ける

---

## 2. 設計方針

### 2.1 基本方針
- **モバイルファースト**: 管理者はスマートフォンでの操作が前提
- **カード型ホーム画面**: 設定アプリのように各セクションをカードとして一覧表示
- **画面遷移方式**: ホーム → セクション編集画面 の1階層遷移
- **モダンデザイン**: グラデーション、シャドウ、アクセント色を活用した華やかなUI

### 2.2 カラーパレット（既存ベースに拡張）
- メインカラー: 現在の緑ベースを維持（#2d5016, #4a7c59）
- 各セクションのカードに個別のアクセント色を付与し、視認性を向上

---

## 3. 画面構成

### 3.1 ログイン画面（既存を維持）
- 現在のデザインを基本的に維持
- 変更なし

### 3.2 ホーム画面（新規）
ログイン後に表示されるメイン画面。

**レイアウト:**
- ヘッダー：サイト名 + ログアウトボタン + サイトを見るリンク
- カードグリッド：2列グリッド（モバイル）/ 3-4列（デスクトップ）

**カード一覧（7枚）:**

| # | セクション名 | アイコン | カード色（グラデーション方向のアクセント） |
|---|-------------|---------|-----|
| 1 | 活動報告 | `fa-newspaper` | 緑系 |
| 2 | ヒーロー | `fa-image` | 青系 |
| 3 | サークル紹介 | `fa-users` | オレンジ系 |
| 4 | 百人一首・競技かるた | `fa-layer-group` | 紫系 |
| 5 | 活動内容 | `fa-calendar-alt` | ティール系 |
| 6 | よくある質問 | `fa-question-circle` | ピンク系 |
| 7 | お問い合わせ | `fa-envelope` | インディゴ系 |

**各カードの構成要素:**
- アイコン（Font Awesome、大きめ表示）
- セクション名（タイトル）
- カード全体がタップ領域（モバイルで押しやすい最低 80px 高さ）

### 3.3 各セクション編集画面

**共通レイアウト:**
```
┌─────────────────────────────────┐
│ ← 戻る   セクション名           │  ← サブヘッダー
├─────────────────────────────────┤
│                                 │
│  （各セクション固有のフォーム）     │  ← コンテンツエリア
│                                 │
└─────────────────────────────────┘
```

- サブヘッダーに「← 戻る」ボタンとセクション名を表示
- コンテンツエリアは各セクション固有のUI

---

## 4. 各セクション編集画面の詳細

### 4.1 活動報告
**一覧画面:**
- カード形式に変更（テーブル廃止）
- 各カード：サムネイル画像 + 日付 + タイトル + 編集・削除ボタン
- 上部に「＋ 新規作成」ボタン

**編集画面:**
- 既存の編集フォームを流用（日付、タイトル、説明、画像アップロード）
- 保存・キャンセルボタン

### 4.2 ヒーロー
**フォーム要素:**
- サブタイトル（textarea、`<br>`対応のヒント付き）
- 主ボタン テキスト（input）
- 主ボタン リンク先（input）
- 副ボタン テキスト（input）
- 副ボタン リンク先（input）
- 保存ボタン

### 4.3 サークル紹介
**フォーム要素:**
- 紹介文（input）
- 説明文（textarea、HTML対応のヒント付き）
- 画像アップロード（プレビュー付き、Cloudinary経由）
- 保存ボタン

### 4.4 百人一首・競技かるた
**一覧 + CRUD:**
- カード一覧（サムネイル + タイトル + 説明の一部）
- 各カードに：編集・削除・↑↓並び替えボタン
- 「＋ 新規カード追加」ボタン

**編集フォーム（インラインまたはモーダル）:**
- タイトル（input）
- 画像アップロード（Cloudinary）
- 説明文（textarea）
- 保存・キャンセルボタン

### 4.5 活動内容
**フォーム要素（3枚のカードをまとめて編集）:**
- カードごとに区切り線で分離
- アイコン（emoji input）
- タイトル（input）
- 本文（textarea、HTML対応）
- まとめて保存ボタン

### 4.6 よくある質問
**一覧 + CRUD:**
- FAQ一覧（質問テキスト + 回答の一部）
- 各項目に：編集・削除・↑↓並び替えボタン
- 「＋ 新規FAQ追加」ボタン

**編集フォーム:**
- 質問（input）
- 回答（textarea）
- 保存・キャンセルボタン

### 4.7 お問い合わせ
**フォーム要素:**
- LINE URL（url input）
- Instagram URL（url input）
- X (Twitter) URL（url input）
- メールアドレス（email input）
- 保存ボタン

---

## 5. レスポンシブデザイン

### 5.1 モバイル（~768px）
- ホームカード：2列グリッド
- フォーム：1列フルワイド
- タップ領域：最低44px × 44px
- 入力フォーム：font-size 16px以上（iOSズーム防止）

### 5.2 タブレット・デスクトップ（768px~）
- ホームカード：3〜4列グリッド
- フォーム：中央寄せ max-width: 800px
- ボタン：ホバーエフェクトあり

---

## 6. 技術仕様

### 6.1 変更ファイル一覧

| ファイル | 種別 | 内容 |
|---------|------|------|
| `admin/index.html` | 改修 | ホーム画面 + 各セクション編集画面HTML |
| `css/admin.css` | 改修 | モバイルファーストの全面リニューアル |
| `js/admin.js` | 改修 | ホーム画面遷移 + 各セクション編集ロジック |
| `js/supabase-client.js` | 改修 | CMSテーブル用メソッド追加 |
| `js/site-loader.js` | 新規 | 公開ページの動的コンテンツ読み込み |
| `index.html` | 改修 | 動的更新対象のID付与 + script追加 |

### 6.2 画面遷移フロー
```
ログイン画面
    ↓ (パスワード認証)
ホーム画面（7枚のカードグリッド）
    ↓ (カードタップ)
セクション編集画面
    ├── 単純フォーム型: ヒーロー、サークル紹介、活動内容、お問い合わせ
    └── CRUD一覧型: 活動報告、百人一首、FAQ
            ↓ (新規/編集)
        編集フォーム画面
```

### 6.3 SupabaseClient追加メソッド
前回のCMS実装計画と同一の12メソッドを追加:
- `getSiteContents(sectionKey?)`, `updateSiteContents(sectionKey, fields)`
- `getKarutaCards()`, `createKarutaCard(data)`, `updateKarutaCard(id, data)`, `deleteKarutaCard(id)`
- `getActivityCards()`, `updateActivityCard(id, data)`
- `getFaqItems()`, `createFaqItem(data)`, `updateFaqItem(id, data)`, `deleteFaqItem(id)`

### 6.4 site-loader.js
前回のCMS実装と同一の構成で公開ページを動的に更新:
- `loadHeroSection()`, `loadAboutSection()`, `loadKarutaSection()`
- `loadActivitiesSection()`, `loadFaqSection()`, `loadContactSection()`
- フォールバック: DB取得失敗時はHTMLデフォルト値を表示

---

## 7. 実装スコープ外

以下は今回のスコープに含めない:
- ログイン画面のデザイン変更
- 認証方式の変更（引き続きローカルストレージ + パスワード）
- 新しいDBテーブルの作成（既存テーブルをそのまま使用）
